app-id: org.geany.Geany
runtime: org.freedesktop.Sdk
runtime-version: '23.08'
sdk: org.freedesktop.Sdk

command: geany
rename-icon: geany
copy-icon: true
rename-desktop-file: geany.desktop

finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --share=network
  - --filesystem=host
  - --filesystem=xdg-run/geany:create

modules:
  - shared-modules/intltool/intltool-0.51.json
  - name: vte
    buildsystem: meson
    config-opts:
      - -Ddocs=false
      - -Dvapi=false
      - -Dgir=false
    sources:
      - type: git
        url: https://gitlab.gnome.org/GNOME/vte.git
        tag: 0.72.3
        commit: 16e9ee71c1534fa91f15c3240f3276cc061894ea
        x-checker-data:
          type: git
          tag-pattern: ^([\d.]+)$
          versions:
            <: '0.73'
  - name: geany
    config-opts:
      - --disable-api-docs
    sources:
      - type: archive
        url: https://download.geany.org/geany-2.0.tar.bz2
        sha256: 565b4cd2f0311c1e3a167ec71c4a32dba642e0fe554ae5bb6b8177b7a74ccc92
        x-checker-data:
          type: html
          url: https://www.geany.org/download/releases
          pattern: (https://download.geany.org/geany-([\d\.]+).tar.bz2)
      - type: file
        path: org.geany.Geany.appdata.xml
      - type: shell
        commands:
          - sed -i 's/firefox/xdg-open/' src/keyfile.c
    post-install:
      - install -Dm644 -t /app/share/metainfo org.geany.Geany.appdata.xml
